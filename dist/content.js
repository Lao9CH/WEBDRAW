(()=>{"use strict";var t={201:(t,n,e)=>{e.d(n,{A:()=>r});var o=e(601),s=e.n(o),i=e(314),a=e.n(i)()(s());a.push([t.id,".web-canvas-container {\n  position: fixed;\n  bottom: 20px;\n  right: 20px;\n  z-index: 10000;\n}\n\n.web-canvas-toggle {\n  width: 48px;\n  height: 48px;\n  border-radius: 50%;\n  background: #4F46E5;\n  border: none;\n  color: white;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);\n  transition: transform 0.2s;\n}\n\n.web-canvas-toggle:hover {\n  transform: scale(1.1);\n}\n\n.web-canvas-toggle.active {\n  background: #DC2626;\n}\n\n.web-canvas {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  z-index: 9999;\n  display: none;\n  pointer-events: all;\n}\n\n.web-canvas.temp {\n  pointer-events: none;\n  z-index: 10000;\n}\n\n.web-canvas-toolbar {\n  position: fixed;\n  top: 20px;\n  left: 50%;\n  transform: translateX(-50%);\n  z-index: 10001;\n  background: white;\n  border-radius: 8px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);\n  padding: 12px;\n  display: flex;\n  gap: 16px;\n  align-items: center;\n}\n\n.tool-group {\n  display: flex;\n  gap: 8px;\n}\n\n.tool-button {\n  width: 40px;\n  height: 40px;\n  border-radius: 6px;\n  border: 1px solid #E5E7EB;\n  background: white;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: #6B7280;\n  transition: all 0.2s;\n}\n\n.tool-button:hover {\n  background: #F3F4F6;\n}\n\n.tool-button.active {\n  background: #EEF2FF;\n  border-color: #4F46E5;\n  color: #4F46E5;\n}\n\n.color-picker {\n  display: flex;\n  gap: 8px;\n}\n\n.color-option {\n  width: 24px;\n  height: 24px;\n  border-radius: 50%;\n  cursor: pointer;\n  border: 2px solid white;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n  transition: transform 0.2s;\n}\n\n.color-option:hover {\n  transform: scale(1.1);\n}\n\n.slider-control {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.slider-control span {\n  font-size: 14px;\n  color: #4B5563;\n  min-width: 48px;\n}\n\n.slider-control input {\n  width: 100px;\n}\n\n.shape-library {\n  position: fixed;\n  top: 50%;\n  right: 80px;\n  transform: translateY(-50%);\n  background: white;\n  border-radius: 8px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);\n  padding: 16px;\n  z-index: 10002;\n}\n\n.shape-grid {\n  display: grid;\n  grid-template-columns: repeat(2, 1fr);\n  gap: 8px;\n}\n\n.shape-item {\n  width: 48px;\n  height: 48px;\n  border: 1px solid #E5E7EB;\n  border-radius: 4px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  transition: all 0.2s;\n}\n\n.shape-item:hover {\n  background: #F3F4F6;\n  border-color: #D1D5DB;\n}\n\n.shape-item.active {\n  background: #4F46E5;\n  border-color: #4F46E5;\n  color: white;\n}\n\n.web-canvas-right-toolbar {\n  position: fixed;\n  top: 50%;\n  right: 20px;\n  transform: translateY(-50%);\n  z-index: 10001;\n  background: white;\n  border-radius: 8px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);\n  padding: 12px;\n  display: none;\n  flex-direction: column;\n  gap: 12px;\n}\n\n.right-toolbar-group {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n\n.right-toolbar-group .tool-button {\n  width: 40px;\n  height: 40px;\n  border-radius: 8px;\n  background: white;\n  border: 1px solid #E5E7EB;\n  color: #4B5563;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s;\n}\n\n.right-toolbar-group .tool-button:hover {\n  background: #F3F4F6;\n  border-color: #D1D5DB;\n}\n\n.right-toolbar-group .tool-button.active {\n  background: #4F46E5;\n  border-color: #4F46E5;\n  color: white;\n}\n\n.right-toolbar-group .tool-button svg {\n  width: 20px;\n  height: 20px;\n}\n\n/* 文本输入框样式 */\n.text-input {\n  position: fixed;\n  background: transparent;\n  border: none;\n  outline: none;\n  font-family: Arial;\n  padding: 0;\n  margin: 0;\n  z-index: 10001;\n  display: none;\n}\n\n/* 选择区域样式 */\n.selection-area {\n  position: absolute;\n  border: 1px dashed #4F46E5;\n  background: rgba(79, 70, 229, 0.1);\n  pointer-events: none;\n  z-index: 10000;\n}",""]);const r=a},314:t=>{t.exports=function(t){var n=[];return n.toString=function(){return this.map((function(n){var e="",o=void 0!==n[5];return n[4]&&(e+="@supports (".concat(n[4],") {")),n[2]&&(e+="@media ".concat(n[2]," {")),o&&(e+="@layer".concat(n[5].length>0?" ".concat(n[5]):""," {")),e+=t(n),o&&(e+="}"),n[2]&&(e+="}"),n[4]&&(e+="}"),e})).join("")},n.i=function(t,e,o,s,i){"string"==typeof t&&(t=[[null,t,void 0]]);var a={};if(o)for(var r=0;r<this.length;r++){var l=this[r][0];null!=l&&(a[l]=!0)}for(var h=0;h<t.length;h++){var c=[].concat(t[h]);o&&a[c[0]]||(void 0!==i&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=i),e&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=e):c[2]=e),s&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=s):c[4]="".concat(s)),n.push(c))}},n}},601:t=>{t.exports=function(t){return t[1]}},72:t=>{var n=[];function e(t){for(var e=-1,o=0;o<n.length;o++)if(n[o].identifier===t){e=o;break}return e}function o(t,o){for(var i={},a=[],r=0;r<t.length;r++){var l=t[r],h=o.base?l[0]+o.base:l[0],c=i[h]||0,d="".concat(h," ").concat(c);i[h]=c+1;var p=e(d),u={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==p)n[p].references++,n[p].updater(u);else{var g=s(u,o);o.byIndex=r,n.splice(r,0,{identifier:d,updater:g,references:1})}a.push(d)}return a}function s(t,n){var e=n.domAPI(n);return e.update(t),function(n){if(n){if(n.css===t.css&&n.media===t.media&&n.sourceMap===t.sourceMap&&n.supports===t.supports&&n.layer===t.layer)return;e.update(t=n)}else e.remove()}}t.exports=function(t,s){var i=o(t=t||[],s=s||{});return function(t){t=t||[];for(var a=0;a<i.length;a++){var r=e(i[a]);n[r].references--}for(var l=o(t,s),h=0;h<i.length;h++){var c=e(i[h]);0===n[c].references&&(n[c].updater(),n.splice(c,1))}i=l}}},659:t=>{var n={};t.exports=function(t,e){var o=function(t){if(void 0===n[t]){var e=document.querySelector(t);if(window.HTMLIFrameElement&&e instanceof window.HTMLIFrameElement)try{e=e.contentDocument.head}catch(t){e=null}n[t]=e}return n[t]}(t);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(e)}},540:t=>{t.exports=function(t){var n=document.createElement("style");return t.setAttributes(n,t.attributes),t.insert(n,t.options),n}},56:(t,n,e)=>{t.exports=function(t){var n=e.nc;n&&t.setAttribute("nonce",n)}},825:t=>{t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var n=t.insertStyleElement(t);return{update:function(e){!function(t,n,e){var o="";e.supports&&(o+="@supports (".concat(e.supports,") {")),e.media&&(o+="@media ".concat(e.media," {"));var s=void 0!==e.layer;s&&(o+="@layer".concat(e.layer.length>0?" ".concat(e.layer):""," {")),o+=e.css,s&&(o+="}"),e.media&&(o+="}"),e.supports&&(o+="}");var i=e.sourceMap;i&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),n.styleTagTransform(o,t,n.options)}(n,t,e)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(n)}}}},113:t=>{t.exports=function(t,n){if(n.styleSheet)n.styleSheet.cssText=t;else{for(;n.firstChild;)n.removeChild(n.firstChild);n.appendChild(document.createTextNode(t))}}}},n={};function e(o){var s=n[o];if(void 0!==s)return s.exports;var i=n[o]={id:o,exports:{}};return t[o](i,i.exports,e),i.exports}function o(t,n,e,o=t=>t){return t*o(.5-n*(.5-e))}function s(t,n){return[t[0]+n[0],t[1]+n[1]]}function i(t,n){return[t[0]-n[0],t[1]-n[1]]}function a(t,n){return[t[0]*n,t[1]*n]}function r(t){return[t[1],-t[0]]}function l(t,n){return t[0]*n[0]+t[1]*n[1]}function h(t,n){return t[0]===n[0]&&t[1]===n[1]}function c(t,n){return function(t){return t[0]*t[0]+t[1]*t[1]}(i(t,n))}function d(t){return function(t,n){return[t[0]/n,t[1]/n]}(t,function(t){return Math.hypot(t[0],t[1])}(t))}function p(t,n){return Math.hypot(t[1]-n[1],t[0]-n[0])}function u(t,n,e){let o=Math.sin(e),s=Math.cos(e),i=t[0]-n[0],a=t[1]-n[1],r=i*o+a*s;return[i*s-a*o+n[0],r+n[1]]}function g(t,n,e){return s(t,a(i(n,t),e))}function v(t,n,e){return s(t,a(n,e))}e.n=t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},e.d=(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},e.o=(t,n)=>Object.prototype.hasOwnProperty.call(t,n),e.nc=void 0;var{min:b,PI:x}=Math,f=x+1e-4;class m{constructor(t){this.canvas=null,this.ctx=null,this.tempCanvas=null,this.tempCtx=null,this.isDrawing=!1,this.points=[],this.startPoint=null,this.toolManager=t,this.init()}init(){this.createCanvas(),this.createTempCanvas(),window.addEventListener("resize",(()=>this.resizeCanvas()))}createCanvas(){this.canvas=document.createElement("canvas"),this.canvas.className="web-canvas",this.ctx=this.canvas.getContext("2d"),document.body.appendChild(this.canvas),this.resizeCanvas()}createTempCanvas(){this.tempCanvas=document.createElement("canvas"),this.tempCanvas.className="web-canvas temp",this.tempCtx=this.tempCanvas.getContext("2d"),document.body.appendChild(this.tempCanvas),this.resizeCanvas()}resizeCanvas(){this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.tempCanvas&&(this.tempCanvas.width=window.innerWidth,this.tempCanvas.height=window.innerHeight,this.tempCtx.lineCap="round",this.tempCtx.lineJoin="round")}startDrawing(t,n){this.isDrawing=!0,this.points=[],this.startPoint={x:t,y:n},this.addPoint(t,n)}draw(t,n,e){this.isDrawing&&("brush"===e.tool||"eraser"===e.tool?this.drawFreehand(t,n,e):"shape"===e.tool?this.drawShapePreview(t,n,e):"text"===e.tool?this.drawTextPreview(t,n,e):"selection"===e.tool&&this.updateSelection(t,n))}drawFreehand(t,n,{color:e,size:x,tool:m}){if(this.addPoint(t,n),this.points.length<2)return;const y=function(t,n={}){return function(t,n={}){let{size:e=16,smoothing:h=.5,thinning:p=.5,simulatePressure:x=!0,easing:m=t=>t,start:y={},end:w={},last:C=!1}=n,{cap:M=!0,easing:E=t=>t*(2-t)}=y,{cap:T=!0,easing:k=t=>--t*t*t+1}=w;if(0===t.length||e<=0)return[];let L,S=t[t.length-1].runningLength,z=!1===y.taper?0:!0===y.taper?Math.max(e,S):y.taper,P=!1===w.taper?0:!0===w.taper?Math.max(e,S):w.taper,F=Math.pow(e*h,2),I=[],B=[],D=t.slice(0,10).reduce(((t,n)=>{let o=n.pressure;if(x){let s=b(1,n.distance/e),i=b(1,1-s);o=b(1,t+.275*s*(i-t))}return(t+o)/2}),t[0].pressure),H=o(e,p,t[t.length-1].pressure,m),A=t[0].vector,R=t[0].point,N=R,j=R,q=N,U=!1;for(let n=0;n<t.length;n++){let{pressure:h}=t[n],{point:d,vector:v,distance:y,runningLength:w}=t[n];if(n<t.length-1&&S-w<3)continue;if(p){if(x){let t=b(1,y/e),n=b(1,1-t);h=b(1,D+.275*t*(n-D))}H=o(e,p,h,m)}else H=e/2;void 0===L&&(L=H);let C=w<z?E(w/z):1,M=S-w<P?k((S-w)/P):1;H=Math.max(.01,H*Math.min(C,M));let T=(n<t.length-1?t[n+1]:t[n]).vector,V=n<t.length-1?l(v,T):1,O=null!==V&&V<0;if(l(v,A)<0&&!U||O){let t=a(r(A),H);for(let n=1/13,e=0;e<=1;e+=n)j=u(i(d,t),d,f*e),I.push(j),q=u(s(d,t),d,f*-e),B.push(q);R=j,N=q,O&&(U=!0);continue}if(U=!1,n===t.length-1){let t=a(r(v),H);I.push(i(d,t)),B.push(s(d,t));continue}let W=a(r(g(T,v,V)),H);j=i(d,W),(n<=1||c(R,j)>F)&&(I.push(j),R=j),q=s(d,W),(n<=1||c(N,q)>F)&&(B.push(q),N=q),D=h,A=v}let V=t[0].point.slice(0,2),O=t.length>1?t[t.length-1].point.slice(0,2):s(t[0].point,[1,1]),W=[],Y=[];if(1===t.length){if(!z&&!P||C){let t=v(V,d(r(i(V,O))),-(L||H)),n=[];for(let e=1/13,o=e;o<=1;o+=e)n.push(u(t,V,2*f*o));return n}}else{if(!(z||P&&1===t.length))if(M)for(let t=1/13,n=t;n<=1;n+=t){let t=u(B[0],V,f*n);W.push(t)}else{let t=i(I[0],B[0]),n=a(t,.5),e=a(t,.51);W.push(i(V,n),i(V,e),s(V,e),s(V,n))}let n=r(function(t){return[-t[0],-t[1]]}(t[t.length-1].vector));if(P||z&&1===t.length)Y.push(O);else if(T){let t=v(O,n,H);for(let n=1/29,e=n;e<1;e+=n)Y.push(u(t,O,3*f*e))}else Y.push(s(O,a(n,H)),s(O,a(n,.99*H)),i(O,a(n,.99*H)),i(O,a(n,H)))}return I.concat(Y,B.reverse(),W)}(function(t,n={}){var e;let{streamline:o=.5,size:a=16,last:r=!1}=n;if(0===t.length)return[];let l=.15+.85*(1-o),c=Array.isArray(t[0])?t:t.map((({x:t,y:n,pressure:e=.5})=>[t,n,e]));if(2===c.length){let t=c[1];c=c.slice(0,-1);for(let n=1;n<5;n++)c.push(g(c[0],t,n/4))}1===c.length&&(c=[...c,[...s(c[0],[1,1]),...c[0].slice(2)]]);let u=[{point:[c[0][0],c[0][1]],pressure:c[0][2]>=0?c[0][2]:.25,vector:[1,1],distance:0,runningLength:0}],v=!1,b=0,x=u[0],f=c.length-1;for(let t=1;t<c.length;t++){let n=r&&t===f?c[t].slice(0,2):g(x.point,c[t],l);if(h(x.point,n))continue;let e=p(n,x.point);if(b+=e,t<f&&!v){if(b<a)continue;v=!0}x={point:n,pressure:c[t][2]>=0?c[t][2]:.5,vector:d(i(x.point,n)),distance:e,runningLength:b},u.push(x)}return u[0].vector=(null==(e=u[1])?void 0:e.vector)||[0,0],u}(t,n),n)}(this.points,{size:x,thinning:.5,smoothing:.5,streamline:.5});this.ctx.fillStyle="eraser"===m?"#fff":e,this.ctx.beginPath();const[w,...C]=y;this.ctx.moveTo(w[0],w[1]),C.forEach((t=>{this.ctx.lineTo(t[0],t[1])})),this.ctx.fill()}drawShapePreview(t,n,e){switch(this.tempCtx.clearRect(0,0,this.tempCanvas.width,this.tempCanvas.height),this.tempCtx.strokeStyle=e.color,this.tempCtx.lineWidth=e.size,e.shape||"rectangle"){case"rectangle":this.drawRectangle(this.tempCtx,this.startPoint.x,this.startPoint.y,t-this.startPoint.x,n-this.startPoint.y);break;case"circle":this.drawCircle(this.tempCtx,this.startPoint.x,this.startPoint.y,t,n);break;case"line":this.drawLine(this.tempCtx,this.startPoint.x,this.startPoint.y,t,n)}}drawTextPreview(t,n,e){this.tempCtx.clearRect(0,0,this.tempCanvas.width,this.tempCanvas.height),this.tempCtx.font=`${e.size}px Arial`,this.tempCtx.fillStyle=e.color,this.tempCtx.fillText(e.text||"Text",t,n)}updateSelection(t,n){this.tempCtx.clearRect(0,0,this.tempCanvas.width,this.tempCanvas.height),this.tempCtx.strokeStyle="#4F46E5",this.tempCtx.lineWidth=1,this.tempCtx.setLineDash([5,5]);const e=t-this.startPoint.x,o=n-this.startPoint.y;this.tempCtx.strokeRect(this.startPoint.x,this.startPoint.y,e,o)}stopDrawing(){if(!this.isDrawing)return;this.isDrawing=!1,this.points=[];const t=this.toolManager.getToolSettings();["shape","text"].includes(t.tool)&&(this.ctx.drawImage(this.tempCanvas,0,0),this.tempCtx.clearRect(0,0,this.tempCanvas.width,this.tempCanvas.height)),this.saveToHistory()}saveToHistory(){const t=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height);this.toolManager.addToHistory(t)}undo(){const t=this.toolManager.undo();t&&this.ctx.putImageData(t,0,0)}redo(){const t=this.toolManager.redo();t&&this.ctx.putImageData(t,0,0)}saveCanvas(){const t=document.createElement("a");t.download="web-canvas.png",t.href=this.canvas.toDataURL(),t.click()}show(){this.canvas.style.display="block",this.tempCanvas.style.display="block"}hide(){this.canvas.style.display="none",this.tempCanvas.style.display="none"}toggleCanvas(t){t?this.show():this.hide()}addPoint(t,n){this.points.push([t,n,Date.now()])}clear(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}drawRectangle(t,n,e,o,s){t.strokeRect(n,e,o,s)}drawCircle(t,n,e,o,s){const i=Math.sqrt(Math.pow(o-n,2)+Math.pow(s-e,2));t.beginPath(),t.arc(n,e,i,0,2*Math.PI),t.stroke()}drawLine(t,n,e,o,s){t.beginPath(),t.moveTo(n,e),t.lineTo(o,s),t.stroke()}}class y{constructor(t,n){this.canvasManager=t,this.toolManager=n,this.isEnabled=!1}createUI(){this.createToggleButton(),this.createToolbar(),this.createShapeLibrary(),this.setupEventListeners()}createToggleButton(){const t=document.createElement("button");t.className="web-canvas-toggle",t.innerHTML='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n      <path d="M12 19l7-7 3 3-7 7-3-3z"></path>\n      <path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"></path>\n      <path d="M2 2l7.586 7.586"></path>\n      <circle cx="11" cy="11" r="2"></circle>\n    </svg>';const n=document.createElement("div");n.className="web-canvas-container",n.appendChild(t),document.body.appendChild(n),this.toggleButton=t}createToolbar(){this.toolbar=document.createElement("div"),this.toolbar.className="web-canvas-toolbar",this.toolbar.style.display="none",document.body.appendChild(this.toolbar),this.rightToolbar=document.createElement("div"),this.rightToolbar.className="web-canvas-right-toolbar",this.rightToolbar.style.display="none",this.rightToolbar.innerHTML=this.getRightToolbarHTML(),document.body.appendChild(this.rightToolbar),this.toolbar.innerHTML=this.getToolbarHTML()}getToolbarHTML(){return'\n      <div class="tool-group">\n        <button class="tool-button active" data-tool="brush">\n          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n            <path d="M12 19l7-7 3 3-7 7-3-3z"></path>\n          </svg>\n        </button>\n        <button class="tool-button" data-tool="eraser">\n          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n            <path d="M20 20H7L3 16l8-8 8 8-4 4"></path>\n          </svg>\n        </button>\n      </div>\n      \n      <div class="color-picker">\n        <div class="color-option" style="background: #4F46E5" data-color="#4F46E5"></div>\n        <div class="color-option" style="background: #DC2626" data-color="#DC2626"></div>\n        <div class="color-option" style="background: #16A34A" data-color="#16A34A"></div>\n        <div class="color-option" style="background: #000000" data-color="#000000"></div>\n      </div>\n      \n      <div class="slider-control">\n        <span>Size:</span>\n        <input type="range" min="1" max="50" value="5" class="brush-size">\n      </div>\n      \n      <div class="slider-control">\n        <span>Smooth:</span>\n        <input type="range" min="0" max="100" value="50" class="smoothness">\n      </div>\n      \n      <button class="tool-button" data-action="clear">\n        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n          <path d="M3 6h18"></path>\n          <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"></path>\n          <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"></path>\n        </svg>\n      </button>\n    '}getRightToolbarHTML(){return'\n      <div class="right-toolbar-group">\n        <button class="tool-button" data-tool="select" title="选择工具">\n          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n            <path d="M3 3l7.07 16.97 2.51-7.39 7.39-2.51L3 3z"></path>\n          </svg>\n        </button>\n        \n        <button class="tool-button" data-tool="shape" title="形状工具">\n          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n            <rect x="3" y="3" width="18" height="18" rx="2"></rect>\n          </svg>\n        </button>\n        \n        <button class="tool-button" data-tool="text" title="文本工具">\n          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n            <path d="M4 7V4h16v3"></path>\n            <path d="M12 4v16"></path>\n            <path d="M7 20h10"></path>\n          </svg>\n        </button>\n        \n        <button class="tool-button" data-tool="undo" title="撤销">\n          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n            <path d="M3 7v6h6"></path>\n            <path d="M3 13c0-4.97 4.03-9 9-9a9 9 0 0 1 9 9 9 9 0 0 1-9 9"></path>\n          </svg>\n        </button>\n        \n        <button class="tool-button" data-tool="redo" title="重做">\n          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n            <path d="M21 7v6h-6"></path>\n            <path d="M21 13c0-4.97-4.03-9-9-9a9 9 0 0 0-9 9 9 9 0 0 0 9 9"></path>\n          </svg>\n        </button>\n        \n        <button class="tool-button" data-tool="save" title="保存">\n          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n            <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>\n            <polyline points="17 21 17 13 7 13 7 21"></polyline>\n            <polyline points="7 3 7 8 15 8"></polyline>\n          </svg>\n        </button>\n      </div>\n    '}createShapeLibrary(){const t=document.createElement("div");t.className="shape-library",t.style.display="none",t.innerHTML=this.getShapeLibraryHTML(),document.body.appendChild(t),this.shapeLibrary=t}getShapeLibraryHTML(){return`\n      <div class="shape-grid">\n        ${["rectangle","circle","triangle","star","arrow","line"].map((t=>`\n          <div class="shape-item" data-shape="${t}">\n            <svg width="32" height="32" viewBox="0 0 32 32">\n              \x3c!-- Shape SVG paths would go here --\x3e\n            </svg>\n          </div>\n        `)).join("")}\n      </div>\n    `}setupEventListeners(){this.toggleButton.addEventListener("click",(()=>this.toggleCanvas())),this.canvasManager.canvas.addEventListener("mousedown",(t=>{this.canvasManager.startDrawing(t.clientX,t.clientY)})),this.canvasManager.canvas.addEventListener("mousemove",(t=>{this.canvasManager.draw(t.clientX,t.clientY,this.toolManager.getToolSettings())})),this.canvasManager.canvas.addEventListener("mouseup",(()=>{this.canvasManager.stopDrawing()})),this.canvasManager.canvas.addEventListener("mouseout",(()=>{this.canvasManager.stopDrawing()})),this.setupToolbarListeners(),this.rightToolbar.addEventListener("click",(t=>{const n=t.target.closest(".tool-button");if(n){switch(n.dataset.tool){case"select":this.toolManager.setCurrentTool("select");break;case"shape":this.toggleShapeLibrary();break;case"text":this.toolManager.setCurrentTool("text");break;case"undo":this.canvasManager.undo();break;case"redo":this.canvasManager.redo();break;case"save":this.canvasManager.saveCanvas()}this.updateToolbarState()}}))}setupToolbarListeners(){this.toolbar.addEventListener("click",(t=>{const n=t.target.closest(".tool-button");if(n){const t=n.dataset.tool;t&&(this.toolManager.setCurrentTool(t),this.toolbar.querySelectorAll(".tool-button").forEach((t=>t.classList.toggle("active",t===n)))),"clear"===n.dataset.action&&this.canvasManager.clear()}})),this.toolbar.querySelectorAll(".color-option").forEach((t=>{t.addEventListener("click",(()=>{const n=t.dataset.color;this.toolManager.setColor(n),this.toolbar.querySelectorAll(".color-option").forEach((n=>n.style.border=n===t?"2px solid #4F46E5":"2px solid white"))}))})),this.toolbar.querySelector(".brush-size").addEventListener("input",(t=>{this.toolManager.setBrushSize(parseInt(t.target.value))})),this.toolbar.querySelector(".smoothness").addEventListener("input",(t=>{this.toolManager.setSmoothness(parseInt(t.target.value)/100)}))}toggleCanvas(){this.isEnabled=!this.isEnabled,this.toggleButton.classList.toggle("active"),this.toolbar.style.display=this.isEnabled?"flex":"none",this.rightToolbar.style.display=this.isEnabled?"flex":"none",this.canvasManager.toggleCanvas(this.isEnabled)}updateToolbarState(){const t=this.toolManager.getToolSettings();document.querySelectorAll(".tool-button").forEach((n=>{const e=n.dataset.tool;n.classList.toggle("active",e===t.tool)}))}toggleShapeLibrary(){"none"===this.shapeLibrary.style.display?(this.shapeLibrary.style.display="block",this.toolManager.setCurrentTool("shape")):this.shapeLibrary.style.display="none"}}class w{constructor(){this.currentTool="brush",this.currentColor="#4F46E5",this.brushSize=5,this.smoothness=.5,this.history=[],this.historyIndex=-1,this.maxHistorySize=50}setCurrentTool(t){["brush","eraser","select","shape","text"].includes(t)&&(this.currentTool=t)}setColor(t){this.currentColor=t}setBrushSize(t){this.brushSize=t}setSmoothness(t){this.smoothness=t}getToolSettings(){return{tool:this.currentTool,color:this.currentColor,size:this.brushSize,smoothness:this.smoothness}}addToHistory(t){this.historyIndex<this.history.length-1&&(this.history=this.history.slice(0,this.historyIndex+1)),this.history.push(t),this.historyIndex++,this.history.length>this.maxHistorySize&&(this.history.shift(),this.historyIndex--)}canUndo(){return this.historyIndex>0}canRedo(){return this.historyIndex<this.history.length-1}undo(){return this.canUndo()?(this.historyIndex--,this.history[this.historyIndex]):null}redo(){return this.canRedo()?(this.historyIndex++,this.history[this.historyIndex]):null}}var C=e(72),M=e.n(C),E=e(825),T=e.n(E),k=e(659),L=e.n(k),S=e(56),z=e.n(S),P=e(540),F=e.n(P),I=e(113),B=e.n(I),D=e(201),H={};H.styleTagTransform=B(),H.setAttributes=z(),H.insert=L().bind(null,"head"),H.domAPI=T(),H.insertStyleElement=F(),M()(D.A,H),D.A&&D.A.locals&&D.A.locals,new class{constructor(){this.canvasManager=new m,this.toolManager=new w,this.uiManager=new y(this.canvasManager,this.toolManager),this.init()}init(){this.uiManager.createUI(),this.setupEventListeners()}setupEventListeners(){document.addEventListener("webcanvas:toolchange",(t=>{this.toolManager.setCurrentTool(t.detail.tool)}))}}})();